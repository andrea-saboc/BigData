# BigData
U Flinku, aplikacije su sastavljene od tokova podataka koji se mogu transformisati korisnički definisanim operatorima. Ovi tokovi podataka formiraju usmerene grafove koji počinju sa jednim ili više izvora i završavaju sa jednim ili više sinkova.

Programi u Flinku su paralelni i distribuirani. Tokom izvršavanja tok podataka ima jednu ili više particija, a svaki operator ima jedan ili više podzadataka. Podzadaci operatora su nezavisni jedan od drugog i izvršavaju se u različitim nitima. 
  
  
  File "/home/consumers/RealTime/02-real_time_processing.py", line 157, in <module>
    df_joined = df.join(df_regions, point_in_the_region_udf(col("start_lon"), col("_lif_lat"), col("the_geom")), how="inner")
  File "/spark/python/lib/pyspark.zip/pyspark/sql/dataframe.py", line 1539, in join
  File "/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1322, in __call__
  File "/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco
pyspark.sql.utils.AnalysisException: join condition 'point_in_the_region(start_lon, _lif_lat, the_geom)' of type string is not a boolean.;
'Join Inner, point_in_the_region(start_lon#162, _lif_lat#114, the_geom#17)#243
:- Project [timestamp#43, key#82, segmentid#69, street#70, _fromst#71, _tost#72, _length#178, _strheading#74, _comments#75, start_lon#162, _lif_lat#114, _lit_lon#130, _lit_lat#146, _last_updt#195, congestion_level#211]
:  +- Project [timestamp#43, key#82, segmentid#69, street#70, _fromst#71, _tost#72, _length#178, _strheading#74, _comments#75, start_lon#162, _lif_lat#114, _lit_lon#130, _lit_lat#146, _traffic#98, _last_updt#195, CASE WHEN (_traffic#98 = -1) THEN UNKNOWN WHEN (_traffic#98 = 0) THEN NO_TRAFFIC WHEN ((_traffic#98 >= 1) AND (_traffic#98 <= 10)) THEN HIGH_CONGESTION WHEN ((_traffic#98 >= 11) AND (_traffic#98 <= 15)) THEN MODERATE_CONGESTION WHEN ((_traffic#98 >= 16) AND (_traffic#98 <= 25)) THEN MILD_CONGESTION WHEN ((_traffic#98 >= 26) AND (_traffic#98 <= 35)) THEN BASIC_UNBLOCKED WHEN (_traffic#98 > 35) THEN UNBLOCKED ELSE NO_VALUE END AS congestion_level#211]
:     +- Project [timestamp#43, key#82, segmentid#69, street#70, _fromst#71, _tost#72, _length#178, _strheading#74, _comments#75, start_lon#162, _lif_lat#114, _lit_lon#130, _lit_lat#146, _traffic#98, convert_to_chicago_tz(_last_updt#81)#194 AS _last_updt#195]
:        +- Project [timestamp#43, key#82, segmentid#69, street#70, _fromst#71, _tost#72, cast(_length#73 as double) AS _length#178, _strheading#74, _comments#75, start_lon#162, _lif_lat#114, _lit_lon#130, _lit_lat#146, _traffic#98, _last_updt#81]
:           +- Project [timestamp#43, key#82, segmentid#69, street#70, _fromst#71, _tost#72, _length#73, _strheading#74, _comments#75, cast(start_lon#76 as double) AS start_lon#162, _lif_lat#114, _lit_lon#130, _lit_lat#146, _traffic#98, _last_updt#81]
:              +- Project [timestamp#43, key#82, segmentid#69, street#70, _fromst#71, _tost#72, _length#73, _strheading#74, _comments#75, start_lon#76, _lif_lat#114, _lit_lon#130, cast(_lit_lat#79 as double) AS _lit_lat#146, _traffic#98, _last_updt#81]
:                 +- Project [timestamp#43, key#82, segmentid#69, street#70, _fromst#71, _tost#72, _length#73, _strheading#74, _comments#75, start_lon#76, _lif_lat#114, cast(_lit_lon#78 as double) AS _lit_lon#130, _lit_lat#79, _traffic#98, _last_updt#81]
:                    +- Project [timestamp#43, key#82, segmentid#69, street#70, _fromst#71, _tost#72, _length#73, _strheading#74, _comments#75, start_lon#76, cast(_lif_lat#77 as double) AS _lif_lat#114, _lit_lon#78, _lit_lat#79, _traffic#98, _last_updt#81]
:                       +- Project [timestamp#43, key#82, segmentid#69, street#70, _fromst#71, _tost#72, _length#73, _strheading#74, _comments#75, start_lon#76, _lif_lat#77, _lit_lon#78, _lit_lat#79, cast(_traffic#80 as int) AS _traffic#98, _last_updt#81]
:                          +- Project [timestamp#43, cast(key#38 as string) AS key#82, parsed_value#60.segmentid AS segmentid#69, parsed_value#60.street AS street#70, parsed_value#60._fromst AS _fromst#71, parsed_value#60._tost AS _tost#72, parsed_value#60._length AS _length#73, parsed_value#60._strheading AS _strheading#74, parsed_value#60._comments AS _comments#75, parsed_value#60.start_lon AS start_lon#76, parsed_value#60._lif_lat AS _lif_lat#77, parsed_value#60._lit_lon AS _lit_lon#78, parsed_value#60._lit_lat AS _lit_lat#79, parsed_value#60._traffic AS _traffic#80, parsed_value#60._last_updt AS _last_updt#81]
:                             +- Project [key#38, value#52, topic#40, partition#41, offset#42L, timestamp#43, timestampType#44, from_json(StructField(segmentid,StringType,true), StructField(street,StringType,true), StructField(_fromst,StringType,true), StructField(_tost,StringType,true), StructField(_length,StringType,true), StructField(_strheading,StringType,true), StructField(_comments,StringType,true), StructField(start_lon,StringType,true), StructField(_lif_lat,StringType,true), StructField(_lit_lon,StringType,true), StructField(_lit_lat,StringType,true), StructField(_traffic,StringType,true), StructField(_last_updt,StringType,true), value#52, Some(GMT)) AS parsed_value#60]
:                                +- Project [key#38, cast(value#39 as string) AS value#52, topic#40, partition#41, offset#42L, timestamp#43, timestampType#44]
:                                   +- StreamingRelationV2 org.apache.spark.sql.kafka010.KafkaSourceProvider@33743f2e, kafka, org.apache.spark.sql.kafka010.KafkaSourceProvider$KafkaTable@594095df, [kafka.bootstrap.servers=kafka1:19092, subscribe=chicago-traffic], [key#38, value#39, topic#40, partition#41, offset#42L, timestamp#43, timestampType#44], StreamingRelation DataSource(org.apache.spark.sql.SparkSession@2245334f,kafka,List(),None,List(),None,Map(kafka.bootstrap.servers -> kafka1:19092, subscribe -> chicago-traffic),None), kafka, [key#31, value#32, topic#33, partition#34, offset#35L, timestamp#36, timestampType#37]
+- Relation [the_geom#17,OBJECTID#18,REGION_ID#19,REGION_NAM#20,GLOBALID#21,SHAPE_AREA#22,SHAPE_LEN#23] csv